dataset:
  augmentation:
    train:
    - class_name: albumentations.RandomResizedCrop
      params:
        always_apply: false
        height: ${dataset.image_size}
        interpolation: 1
        p: 1.0
        ratio:
        - 1
        - 1
        scale:
        - 0.8
        - 1.0
        width: ${dataset.image_size}
    - class_name: albumentations.Flip
      params:
        always_apply: false
        p: 0.5
    - class_name: albumentations.RandomGridShuffle
      params:
        always_apply: false
        grid:
        - 4
        - 4
        p: 1.0
    - class_name: albumentations.HueSaturationValue
      params:
        always_apply: false
        hue_shift_limit: 10
        p: 0.5
        sat_shift_limit: 10
        val_shift_limit: 10
    - class_name: albumentations.RandomBrightnessContrast
      params:
        always_apply: false
        brightness_by_max: true
        brightness_limit: 0.2
        contrast_limit: 0.2
        p: 0.5
    - class_name: albumentations.GaussNoise
      params:
        always_apply: false
        mean: 0
        p: 0.5
        var_limit:
        - 10.0
        - 50.0
    - class_name: albumentations.ShiftScaleRotate
      params:
        always_apply: false
        border_mode: 4
        interpolation: 1
        mask_value: null
        p: 0.5
        rotate_limit: 45
        scale_limit: 0.0
        shift_limit: 0.0625
        value: 255
    - class_name: albumentations.Normalize
      params:
        always_apply: false
        max_pixel_value: 255.0
        mean:
        - 0.485
        - 0.456
        - 0.406
        p: 1.0
        std:
        - 0.229
        - 0.224
        - 0.225
    - class_name: albumentations.Cutout
      params:
        always_apply: false
        fill_value: 0
        max_h_size: 8
        max_w_size: 8
        num_holes: 8
        p: 0.5
    valid:
    - class_name: albumentations.Resize
      params:
        always_apply: false
        height: ${dataset.image_size}
        interpolation: 1
        p: 1.0
        width: ${dataset.image_size}
    - class_name: albumentations.Normalize
      params:
        always_apply: false
        max_pixel_value: 255.0
        mean:
        - 0.485
        - 0.456
        - 0.406
        p: 1.0
        std:
        - 0.229
        - 0.224
        - 0.225
  data_dir: ../data
  fold: 4
  image_size: 224
  split:
    class_name: sklearn.model_selection.StratifiedKFold
    params:
      n_splits: 5
      random_state: 2020
      shuffle: true
logging:
  log: true
model:
  backbone:
    class_name: model.model.resnet18
    params:
      num_classes: 1
      pretrained: true
private:
  neptune_api: ANONIMOUS
trainer:
  accumulate_grad_batches: 1
  distributed_backend: dp
  gpus: 1
  max_epochs: 12
  profiler: false
training:
  dataloader:
    train:
      batch_size: 32
      num_workers: 4
      shuffle: true
    valid:
      batch_size: 32
      num_workers: 4
      shuffle: false
  debug: false
  learning_rate: 0.0001
  loss:
    class_name: losses.loss.RMSELoss
    params: {}
  num_classes: 5
  optimizer:
    class_name: torch.optim.Adam
    params:
      lr: ${training.learning_rate}
  scheduler:
    class_name: torch.optim.lr_scheduler.ReduceLROnPlateau
    params:
      eps: 1.0e-08
      factor: 0.5
      mode: min
      patience: 5
      verbose: true
